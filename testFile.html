<div class="w-full h-full bg-gray-900 px-4 sm:px-6 lg:px-8 py-8" x-data="racePlanner()">
  <div class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 min-h-screen grid grid-cols-1 lg:grid-cols-3 gap-6">

    <div class="lg:col-span-1 space-y-6">

      <div class="rounded-lg bg-gray-800 p-6 shadow-lg ring-1 ring-white/15">
        <h3 class="text-lg font-semibold text-white">Race Details</h3>
        <p class="text-sm text-gray-400">What type of race are you training for and how long do you have to train?</p>
        <br/>
        <div>
          <label for="raceDistance" class="block text-sm font-medium text-gray-300 mb-2">
            Race Distance
          </label>
          <select 
            id="raceDistance" 
            x-model="selectedRaceDistance" 
            class="w-full bg-gray-700 p-2 rounded focus:outline-none focus:ring focus:ring-indigo-500"
          >
            <option value="" disabled>Select a distance</option>
            <template x-for="option in raceDistanceOptions" :key="option.value">
              <option :value="option.value" x-text="option.label"></option>
            </template>
          </select>
        </div>
        <br/>
        <div>
          <label
            for="raceDate"
            class="block text-sm font-medium text-gray-300 flex items-center gap-1 mb-2"
          >
            Training Block
          </label>
          <select 
            id="raceDate" 
            x-model="selectedRaceDate" 
            class="w-full text-black bg-gray-700 p-2 rounded focus:outline-none focus:ring focus:ring-indigo-500"
          >
            <option value="" disabled>Select a date</option>
            <template x-for="option in raceDateOptions" :key="option.value">
              <option :value="option.value" x-text="option.label"></option>
            </template>
          </select>
        </div>
      </div>

      <div class="rounded-lg bg-gray-800 p-6 shadow-lg ring-1 ring-white/15">
        <h3 class="text-lg font-semibold text-white">Experience Level</h3>
        <p class="text-sm text-gray-400">Based on your running experience, select the level that makes most sense for you.</p>
        <br/>
        <div class="plan-selection mb-4">
          <label class="inline-flex items-center mr-4">
              <input type="radio" name="planType" value="beginner" class="form-radio text-blue-600" @change="selectPlan('beginner')"/>
              <span class="ml-2 text-white">Beginner</span>
          </label>
          <br/>
          <label class="inline-flex items-center mr-4">
              <input type="radio" name="planType" value="intermediate" class="form-radio text-blue-600" @change="selectPlan('intermediate')"/>
              <span class="ml-2 text-white">Intermediate</span>
          </label>
          <br/>
          <label class="inline-flex items-center mr-4">
              <input type="radio" name="planType" value="advanced" class="form-radio text-blue-600" @change="selectPlan('advanced')"/>
              <span class="ml-2 text-white">Advanced</span>
          </label>
        </div>
      </div>

      <div class="rounded-lg bg-gray-800 p-6 shadow-lg ring-1 ring-white/15">
        <h3 class="text-lg font-semibold text-white">Approach To Training</h3>
        <p class="text-sm text-gray-400">
          Select a pre-made training template, or start from scratch and create your own.
        </p>
        <div class="mt-4 flex justify-start space-x-2">
          <!-- Button Group -->
          <button
            type="button"
            class="inline-flex items-center rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          >
            Pre-made
          </button>
          <button
            type="button"
            class="inline-flex items-center rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500"
          >
            Custom
          </button>
        </div>
      </div>

    </div>
           

    <!-- Right Column -->
    <div class="lg:col-span-2">
      <div class="rounded-lg bg-gray-800 p-6 shadow-lg ring-1 ring-white/15 h-full">
        <div x-data="tabsComponent()">
          <!-- Dropdown for small screens -->
          <div class="grid grid-cols-1 sm:hidden">
            <select
              x-model="currentTab"
              aria-label="Select a tab"
              class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-2 pl-3 pr-8 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600"
            >
              <template x-for="tab in tabs" :key="tab.name">
                <option :value="tab.name" x-text="tab.name"></option>
              </template>
            </select>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="pointer-events-none col-start-1 row-start-1 mr-2 w-5 h-5 self-center justify-self-end fill-gray-500"
              viewBox="0 0 20 20"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4 4a.75.75 0 01-1.06 0l-4-4a.75.75 0 01.02-1.06z"
                clip-rule="evenodd"
              />
            </svg>
          </div>
        
          <!-- Tabs for larger screens -->
          <div class="hidden sm:block">
            <div class="border-b border-gray-200">
              <nav aria-label="Tabs" class="-mb-px flex">
                <template x-for="tab in tabs" :key="tab.name">
                  <a
                    href="#"
                    @click.prevent="currentTab = tab.name"
                    :aria-current="currentTab === tab.name ? 'page' : undefined"
                    :class="currentTab === tab.name
                      ? 'border-indigo-500 text-indigo-600'
                      : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'"
                    class="w-1/4 border-b-2 px-1 py-4 text-center text-sm font-medium"
                    x-text="tab.name"
                  ></a>
                </template>
              </nav>
            </div>
          </div>
        
          <!-- Tab Content -->
          <div class="mt-6">
            <template x-if="currentTab === 'Overview'">
              <div
                x-data="editableTable()"
                class="bg-gray-900 min-h-screen p-6 overflow-hidden"
              >
                <div class="mx-auto max-w-7xl">
                  <h1 class="text-base font-semibold text-white">Weekly Training Plan</h1>
                  <p class="mt-2 text-sm text-gray-300">
                    Double-click a cell to edit and enter notes. Press "Esc" to exit a cell.
                  </p>
                  <div
                    class="mt-8 flow-root border border-gray-800 rounded-lg overflow-hidden"
                    style="max-height: 600px; overflow-y: auto;"
                  >
                    <table class="min-w-full divide-y divide-gray-700">
                      <!-- Table Head -->
                      <thead>
                        <tr>
                          <template x-for="day in days" :key="day">
                            <th
                              scope="col"
                              class="py-3.5 px-3 text-left text-sm font-semibold text-white"
                              x-text="day"
                            ></th>
                          </template>
                        </tr>
                      </thead>
                      <!-- Table Body -->
                      <tbody class="divide-y divide-gray-800">
                        <template x-for="(week, index) in weeks" :key="index">
                          <tr>
                            <template x-for="(value, day) in week" :key="day">
                              <td
                                class="px-3 py-4 text-sm text-gray-300 align-top"
                                x-on:dblclick="editCell(index, day)"
                              >
                                <!-- Display Text (Truncated) -->
                                <template x-if="!(editingCell.index === index && editingCell.field === day)">
                                  <div
                                    class="truncate max-h-24 overflow-hidden"
                                    style="white-space: pre-wrap; text-overflow: ellipsis;"
                                    x-text="value"
                                  ></div>
                                </template>
                                <!-- Editable Textarea (Full View) -->
                                <template x-if="editingCell.index === index && editingCell.field === day">
                                  <textarea
                                    class="w-full bg-gray-700 text-white px-2 py-1 rounded focus:outline-indigo-500"
                                    x-model="weeks[index][day]"
                                    x-on:keydown.enter.stop
                                    x-on:keydown.escape="cancelEdit()"
                                    x-on:blur="saveCell()"
                                    rows="3"
                                    style="white-space: pre-wrap;"
                                  ></textarea>
                                </template>
                              </td>
                            </template>
                          </tr>
                        </template>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>                
            </template>
            <template x-if="currentTab === 'Calendar View'">
              <div>
                <h3 class="text-lg font-semibold text-indigo-600">Tab 2 Content</h3>
                <p class="text-gray-600">This is the content for Tab 2.</p>
              </div>
            </template>
            <template x-if="currentTab === 'Training Load Summary'">
              <div>
                <h3 class="text-lg font-semibold text-indigo-600">Tab 3 Content</h3>
                <p class="text-gray-600">This is the content for Tab 3.</p>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function racePlanner() {
    return {
      selectedRaceDistance: '',
      selectedRaceDate: '',
      raceDistanceOptions: [
        { label: '5K', value: '5k' },
        { label: '10K', value: '10k' },
        { label: 'Half Marathon', value: 'half-marathon' },
        { label: 'Marathon', value: 'marathon' },
      ],
      raceDateOptions: [
        { label: '4 Week Training Plan', value: '4-weeks' },
        { label: '8 Week Training Plan', value: '8-weeks' },
        { label: '12 Week Training Plan', value: '12-weeks' },
        { label: '16 Week Training Plan', value: '16-weeks' },
        { label: '20 Week Training Plan', value: '20-weeks' },
      ],
    };
  }

  function tabsComponent() {
    return {
      // Initialize the tabs data
      currentTab: 'Overview',
      tabs: [
        { name: 'Overview' },
        { name: 'Calendar View' },
        { name: 'Training Load Summary' }
      ],
    };
  }

  function editableTable() {
    return {
      // Days of the week
      days: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],
      // Weekly training plan with sample data
      weeks: [
        {
          Monday: '5 miles easy run\nFocus on breathing and steady pace.',
          Tuesday: '4 miles tempo run\nWarm-up: 1 mile\nTempo: 2 miles @ 8:00 min/mile\nCool-down: 1 mile',
          Wednesday: '5 miles recovery run\nKeep heart rate low.',
          Thursday: 'Rest day\nOptional yoga or light stretching.',
          Friday: '7 miles long run\nProgressive pace, finish strong.',
          Saturday: '8 miles trail run\nPractice uphill strides.',
          Sunday: '3 miles recovery run\nSlow pace, enjoy the scenery.',
        },
        {
          Monday: '6 miles interval run\nWarm-up: 1 mile\n5x800m @ 7:30 min/mile\nCool-down: 1 mile',
          Tuesday: '4 miles easy run\nRelaxed pace, focus on form.',
          Wednesday: 'Cross-training\n30 minutes cycling or swimming.',
          Thursday: '5 miles tempo run\nWarm-up: 1 mile\nTempo: 3 miles @ 7:45 min/mile\nCool-down: 1 mile',
          Friday: 'Rest day\nFocus on hydration and nutrition.',
          Saturday: '10 miles long run\nEasy pace, conversational effort.',
          Sunday: '4 miles recovery run\nShake out the legs, stay loose.',
        },
        // Add more rows to simulate 8, 12, 16, or 20 total rows as needed
      ],
      // Cell editing state
      editingCell: { index: null, field: null },
      // Function to edit a cell
      editCell(index, field) {
        this.editingCell = { index, field };
      },
      // Function to save a cell
      saveCell() {
        this.editingCell = { index: null, field: null };
      },
      // Function to cancel editing
      cancelEdit() {
        this.editingCell = { index: null, field: null };
      },
    };
  }

</script>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Training Plan</title>
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <link href="fontawesome-free-6.2.1-web/css/fontawesome.css" rel="stylesheet">
  <link href="fontawesome-free-6.2.1-web/css/brands.css" rel="stylesheet">
  <link href="fontawesome-free-6.2.1-web/css/solid.css" rel="stylesheet">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  </link>
  <link rel="stylesheet" href="calendarComponent.css">
  <script src="calendarComponent.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <link rel="stylesheet" href="./dist/nouislider.min.css">
  <script src="./dist/nouislider.min.js"></script>
  <script src="sliderOptions.js"></script>
</head>
